---
title: "Report"
author: "Jun, Irene, Binh, Weidun"
date: "12/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
```

```{r load-libraries}
library(tidyverse)
library(ggplot2)
library(magrittr)
library(dplyr)
library(readr)
```

```{r load-csv-file}
data <- read.csv("https://wzb-ipi.github.io/corona/df_full.csv") %>%
          filter(elapsed == 334) %>%
          mutate(mortality_rate = deaths_cum / cases_cum)
```

```{r process-data}
data <- data %>%
  select(country, continent, population_2019, pop_density, deaths_cum, cases_cum, mortality_rate, health_exp_pc, soc_insur_cov, healthcare_qual, health_equality, doctors_pc, acc_sanitation)  

data_wo_outliers <- data %>%
  filter(deaths_cum < 100000)

data01 <- data_wo_outliers %>%
  filter(mortality_rate < 0.1) 
```

Health Expenses:

```{r plot-mortality-health-expenses}
ggplot(data, aes(y=mortality_rate, x=health_exp_pc)) +
    geom_smooth()+
    geom_point()+
    labs(title = "Plot between Health Expenses per Capita and COVID-19 mortality",
         subtitle = "All Countries", y = "Mortality Rate", x = "Health Expensees")

ggplot(data01, aes(y=mortality_rate, x=health_exp_pc)) +
    geom_smooth()+
    geom_point()+
    labs(title = "Plot between Health Expenses per Capita and COVID-19 mortality",
         subtitle = "Outliers Removed", y = "Mortality Rate", x = "Health Expensees")

```

```{r}
cor_01 <- cor(data$health_exp_pc, data$mortality_rate, use = "complete.obs")
cor_02 <- cor(data01$health_exp_pc, data01$mortality_rate, use = "complete.obs")

cor_01
cor_02

```

The correlation between health expenses and COVID-19 mortality rate shows no association with the r number around -0.089. We can also infer from the graph that with outliers removed, health expenses have a little to no impact on COVID-19 mortality rate (r = -0.087).

Insurance Coverage

```{r}
ggplot(data, aes(y = mortality_rate, x=soc_insur_cov)) +
    geom_smooth()+
    geom_point()+
    labs(title = "Plot between Social Insurance Coverage and COVID-19 mortality",
         subtitle = "All Countries", y = "Mortality Rate", x = "Insurance Coverage")

ggplot(data01, aes(y = mortality_rate, x=soc_insur_cov)) +
    geom_smooth()+
    geom_point()+
    labs(title = "Plot between Social Insurance Coverage and COVID-19 mortality",
         subtitle = "Outliers Removed", y = "Mortality Rate", x = "Insurance Coverage")
```

```{r}
cor_03 <- cor(data$soc_insur_cov, data$mortality_rate, use = "complete.obs")
cor_04 <- cor(data01$soc_insur_cov, data01$mortality_rate, use = "complete.obs")

cor_03
cor_04
```

Social insurance coverage and COVID-19 mortality rate also shows no association with the r number at -0.107. However after removing outliers they show a weak negative correlation which suggests that insurance coverage have some limited impact on COVID-19 mortality (r = -0.215).

```{r plot-healthcare}

data_healthcare <- data %>%
        filter(is.na(healthcare_qual) == FALSE)
  
  
ggplot(data_healthcare, aes(x = healthcare_qual, y = mortality_rate)) +
       geom_point() +
       geom_smooth() +
       labs(title = "Plot between healthcare quality and COVID-19 mortality",
            subtitle = "All countries",
            x = "Healthcare quality", y = 'Total Deaths')

cor_healthcare <- cor(data_healthcare$healthcare_qual, data_healthcare$mortality_rate)
cor_healthcare
```

The correlation between healthcare quality and mortality of COVID-19 does not seem to be very strong with r = -0.08. Thus, the healthcare quality and the mortality rate among countries are independent to each other.

```{r plot-health-equality}
data_equality <- data %>% filter(is.na(health_equality) == FALSE)

data_equality_wo_outlier <- data_equality %>% filter(mortality_rate < 0.2)

ggplot(data_equality, aes(x = health_equality, y=mortality_rate)) +
       geom_point() +
       geom_smooth() +
       labs(title = "Plot between health equality and COVID-19 mortality",
            subtitle = "All countries",
            x = "Health equality", y = 'Total Deaths')

ggplot(data_equality_wo_outlier, aes(x = health_equality, y=mortality_rate)) +
       geom_point() +
       geom_smooth() +
       labs(title = "Plot between health equality and COVID-19 mortality",
            subtitle = "All countries",
            x = "Health equality", y = 'Total Deaths')


cor_equality <- cor(data_equality$health_equality, data_equality$mortality_rate)
cor_equality
cor_equality_wo_outlier <- cor(data_equality_wo_outlier$health_equality,
                              data_equality_wo_outlier$mortality_rate)
cor_equality_wo_outlier

```
Health eqaulity and the mortality rate are weakly, negatively correlative, with r = -0.27.
However, without the outlier (mortality_rate > 0.2), the correlation becomes visually very weak.
Here is a brief look at the outlier.

```{r pick-outlier}
glimpse(data_equality %>% filter(mortality_rate > 0.2) %>%
          select(country, cases_cum, deaths_cum, mortality_rate, healthcare_qual, health_equality))
```

Thus, we conclude that better health equality does not necessarily lead to less mortality of COVID-19.

Total Deaths vs. Doctors per Capita 

```{r plot-doctors}
data_doctor <- data %>% filter(is.na(doctors_pc) == FALSE)

ggplot(data_doctor, aes(x = doctors_pc, y=mortality_rate)) +
       geom_point() +
       geom_smooth() +
       labs(title = "Mortality Rates vs. Doctors per Capita",
            subtitle = "All countries",
            x = "Doctors per Capita", y = 'Mortality Rate') 
```

```{r correlation_doctors_per_cap}
cor_doctors <- cor(data_doctor$doctors_pc, data_doctor$mortality_rate)
cor_doctors
```

Total Deaths vs. Access to Sanitation 

```{r plot-sanitation}
ggplot(data_doctor, aes(x = acc_sanitation, y=mortality_rate)) +
       geom_point() +
       geom_smooth() +
       labs(title = "Mortality Rates vs. Access to Sanitation",
            subtitle = "All countries",
            x = "Access to Sanitation", y = 'Mortality Rate') 
```

```{r correlation_access_sanitation}
cor_sanitation <- cor(data_doctor$acc_sanitation, data_doctor$mortality_rate)
cor_sanitation
```

